#!/usr/bin/env bash
echo "usage: $0 {{comments}}"
echo
comments=$@

if [[ -z "$comments" ]]; then
  comments="work in progress as of $(date -u +%Y-%m-%dT%H:%M:%S%Z)"
  # Alternative date format $(date -u --rfc-3339=s)
  echo "auto comment set: $comments"
  echo
else
  comments="$comments at $(date -u +%Y-%m-%d_T_%H:%M:%S_%Z)"
  echo "$comments"
  echo
fi

git add .
echo
git commit -m "$comments"
echo
git push

if [[ $(git config --get remote.origin.url) == *"95.165.133.121"* ]]; then
  ssh -p 4961 master@95.165.133.121 "cd git/$(basename $(pwd)).git; echo && echo \"master@95.165.133.121:4961/home/master/git/$(basename $(pwd)).git$ git push\"; git push; ssh -p 4961 tim@10.1.1.250 \"cd git/$(basename $(pwd)).git; echo; git push\""
fi
